
[[req-ea-ers]]
=== Equal-Area Earth DGGS package

==== Equal-Area Earth RS module

This clause specifies the Equal-Area Earth RS module.

For a DGGS RS that is conformant with the DGGS Core to be an EAERS,
it shall satisfy all the requirements for the Equal-Area Earth DGGS package.

The data model supports DGGS EAERS based on either _static_ or _dynamic_ datums.
Care shall be taken when implementing DGGS with static datums.
Static CRS are by their nature only intended for use on one tectonic plate.
However the definition for a DGGS always has a global domain.
This apparent conundrum is resolved in two ways:

[loweralpha]
. *Orientation:*  Noting that some static CRS have one or more points on the Earth's surface where the underlying mathematics is poorly behaved,
orient the EA_BaseUnitPolyhedron so that areas, centroids, vertices, and edges can be computed; and
. *Precision:* On the tectonic plate where the reference frame is static choose the level of DGGS
  precision to suit the intended use of the DGGS (typically in the range of millimetres to 10s of metres),
  and in areas of the Earth on plates that are moving with respect to the static reference frame choose the level of DGGS precision to reflect the larger of the constraints imposed by the mathematics
  and by plate tectonics (typically in the of range 10s to 100 000s of metres).

Dynamic datums present problems of a different form.
The most frequently used is WGS 84, which is a datum ensemble.
Care shall be taken to ensure that the error budget for EA_Cell's area
is set at a value that caters to the level of approximation in the WGS 84 definition.

Figure 20, Figure 21 and Figure 22 show the data models for modules
in the Equal-Area Earth DGGS package.

[[figureEA-1]]
.Components of Equal-Area Earth RS module
image::figures/Fig_ea-rs_ContextforEqual-AreaEarthReferenceSystem.png[align="center"]

See <<defining-tables-for-equal-area-earth-dgg-reference-system>> for definitions of elements in this Figure.

[[figureEA-2]]
.Components of Equal-Area Tessellation module
image::figures/Fig_ea-rs_ComponentsofEqual-AreaTessellations.png[align="center"]

See <<defining-tables-for-tessellation>> for definitions of elements in this Figure.

[[figureEA-3]]
.Components of Equal-Area Cell module
image::figures/Fig_ea-rs_ComponentsofEqual-AreaCell.png[align="center"]

See <<defining-tables-for-cell>> for definitions of elements in this Figure.

[[defining-tables-for-equal-area-earth-dgg-reference-system]]
==== Defining tables

include::../tables/TAB_ea-rs-i.adoc[]
. <<tab-EA_SurfaceInterpolation>> -- Elements of Equal-Area Earth RS::EA_SurfaceInterpolation

include::../tables/TAB_ea-rs.adoc[]

[[tab-EA_SurfaceInterpolation]]
.Elements of Equal-Area Earth RS::EA_SurfaceInterpolation class
[width="100%",cols="8%,10%,20%,20%,6%,8%,8%,20%",]
|===
|*Name:* 7+a| EA_SurfaceInterpolation
|*Definition:* 7+a| Subset of Geometry::SurfaceInterpolation (code list) providing permitted interpolation methods for EA_Cell
|*Stereotype:* 7+a| CodeList
|*Abstract:* 7+a| true
.1+|*Associations:* 7+a| (none)
.3+|*Values:*  | _Name_ 6+a| _Definition_
 | spherical 6+a| The EA_Cell surface is a section of a spherical surface. +
*NOTE* For EA_Cells of sufficiently small extent, linear interpolation is sufficient to meet the `EA_Cell.errorBudget` for area.
 | elliptical 6+a| The EA_Cell surface is a section of an elliptical surface. +
*NOTE* for EA_Cells of sufficiently small extent, spherical interpolation is sufficient to meet the `EA_Cell.errorBudget` for area. +
*NOTE* for EA_Cells of sufficiently small extent, linear interpolation is sufficient to meet the `EA_Cell.errorBudget` for area.
|===

{empty} +
The following requirement applies:
include::../requirements/REQ_ea-ers-harmonized_model.adoc[]

[[req-ea-ers-global_domain]]
==== Global domain

For a DGGS RS to be an EAERS, the domain shall be defined as the entire surface of the Earth.

The following requirement applies:
include::../requirements/REQ_ea-ers-global_domain.adoc[]

==== Equal-Area Tessellation module

===== Tessellation overview

A multiresolution hierarchical tessellation of cells is created by constructing a sequence of discrete global grids, each with successively finer cell resolutions.
First an initial discrete global grid is constructed as described in subclause <<req-ea-ers-tessellation-initial>>.
The cells of this initial tessellation are then iteratively refined by application of cell refinement method(s) <<ref2>> to create finer resolution child cells.
The initial tessellation, the cell shape, the refinement methods and indexing methods may all vary for different DGGSs.

[[req-ea-ers-tessellation-initial]]
===== Initial tessellation

The entire surface of the Earth is partitioned to a finite/discrete set of regions.
Most methods initially approximate the Earth's surface using a simple base unit polyhedron which is scaled so that all vertices are located on the surface model of the Earth, and the edges are warped so they also lie on the surface model.
The resulting edges may be any of the types listed in EA_CurveType.
These include geodesics, small circles, small ellipses and lines that project to a straight line on a plane.
These all result from intersections of a plane and an ellipsoid.
The initial discrete global grid tessellation has the same form as the base unit polyhedron.
Each EA_Cell of the initial tessellation represents one face of the chosen base unit polyhedron mapped to the chosen surface model of the Earth.
This document refers to the initial tessellation as a "polyhedral tessellation".
The most common choices for an initial base unit polyhedron are discussed in subclause <<_criterion>> <<ref2>>.

The following requirement applies:
include::../requirements/REQ_ea-ers-tessellation-initial.adoc[]

[[req-ea-ers-tessellation-sequence]]
===== Tessellation sequence

DGGS EAERS comprise a discrete sequence of global grids formed from recursive application of a tessellation method to refine the grid cells,
so that each global grid has a progressively finer spatial resolution.

The following requirements apply:
include::../requirements/REQ_ea-ers-tessellation-sequence.adoc[]


[[req-ea-ers-tessellation-global_area_preservation]]
===== Global area preservation

Preservation of total surface area throughout the range of hierarchical tessellations is a necessary property of DGGSs in order to represent information
consistently at successive resolutions. This requirement ensures that each level of grid refinement completely covers the Earth's surface without cell overlaps.

The following requirement applies:
include::../requirements/REQ_ea-ers-tessellation-global_area_preservation.adoc[]


[[defining-tables-for-tessellation]]
===== Defining tables

include::../tables/TAB_ea-t-i.adoc[]

include::../tables/TAB_ea-t.adoc[]

==== Equal-Area Cell module

[[req-ea-ers-cell-simple-2d_polygon]]
===== Cells are simple polygons

EA_Cells are simple polygons formed from an ordered set of boundary curves adhering to the geometric reference surface of the Earth model.
EA_Cells are defined in three-dimensional space and are topologically two-dimensional.
Different cell shapes can be used, typically triangle, quadrilateral, pentagon, hexagon, and octagon.
Cells formed from faces of the five (5) Platonic solids (tetrahedron-triangle, cube-quadrilateral, octahedron-triangles, dodecahedron-pentagons, icosahedron-triangles) all satisfy the requirements for simple cells.
Larger numbers of faces and therefore cells at the top of the hierarchy of tessellations, increases the uniformity of the cell shape.
The truncated icosahedron, with thirty-two (32) faces is often used for DGGSs.
It produces mostly hexagons augmented by twelve (12) pentagons in each tessellation.
Each cell shape has its own advantages and disadvantages <<ref2>> and
it is usually desirable for each refined discrete global grid to have a majority of cells with the same shape <<ref10>>,<<ref11>>.
Triangular, quadrilateral and hexagonal cells are common choices used in DGGSs on the surface of the Earth.
These shapes provide regular tiling of the plane <<ref10>>, which can be mapped to a curved surface such as a spherical or ellipsoidal Earth surface model.

The cell structures in each successive level of cell refinement are constrained by the properties of the initial tessellation,
but do not necessarily have the same geometry as the initial tessellation.
Simple two-dimensional cells have the following properties:

[loweralpha]
. edges meet only at the vertices;
. exactly two edges meet at each vertex;
. exactly the same number of edges and vertices; and,
. enclose a region which always has a measurable area.

The following requirement applies:
include::../requirements/REQ_ea-ers-cell-simple-2d_polygon.adoc[]

[[req-ea-ers-cell-direct_position-centroid]]
===== Cells referenced at their centroid

Each EA_Cell shall be referenced at its centroid.
This is because the centroid is the only location that provides a representative point that
behaves consistently with shape and is invariant under orientation.
The representative point for an EA_Cell shall lie on the surface of the cell.
For curved surfaces, the “centre of gravity” computed in three-dimensions cannot
actually lie on the surface (see <<ISO19107-2019, 6.4.4.8>>).
If, however, the “centre of gravity” is computed using distances computed along
geodesic arcs on the curved surface, then the centroid is constrained to lie on the surface.
This is a centroid calculated as the “geodesic centre of surface area” of an EA_Cell.

The centroid enables a dual representation of a DGGS tessellation as both two-dimensional areal cell grids and as point-based lattices of cell reference locations.

The following requirement applies:
include::../requirements/REQ_ea-ers-cell-direct_position-centroid.adoc[]

[[req-ea-ers-cell-equal_area]]
===== Cells of equal area

This document defines an EAERS based on a hierarchy of equal area tessellations.
Cells of equal area provide global grids with spatial units that (at multiple resolutions) have
an equal probability of contributing to an analysis.
Equal area cells also help to minimize the confounding effects of area variations
in spatial analyses where the curved surface of the earth is the fundamental reference frame.

In an EAERS the unit of measure is a unit of area,
not length as in a cartesian XYZ coordinate system or angle as in an ellipsoidal coordinate system.
For angular measures the degree is defined as one 360th integer fraction of a full circle,
and by analogy the areal unit of measure of a DGGS coordinate reference system
is an integer fraction of the surface area of the chosen ellipsoidal surface model for the earth.
For DGGSs the integer fraction is the number of cells in the initial discrete global grid.
Continuing the angular analogy with minutes being 1/60th of a degree
and seconds being 1/60th of a minute, for DGGSs,
recursive use of the refinement ratio generates a sequence of smaller areal units,
one for each refined discrete global grid.

Standard units of measure are defined through a reference measure with defined precision.
The meter unit of length has been redefined a number of times as technology has improved.
For example:

[loweralpha]
. *From 1793:* 1/10 000 000 of the meridian through Paris between the North Pole
  and the Equator (+/- ~10^-4^ m); and
. *From 1983:* The length of the path travelled by light in a vacuum
  in 1/299 792 458^th^ of a second (+/- 10^-10^ m).

To address the need for transparency of the precision in its units of area,
this document uses the concept of a specified error budget.
The error budget takes into account all sources of variation that
are relevant to the particular DGGS, its derivation, and its expected use.
For most day to day uses, most of these sources contribute errors that
are significantly smaller than the precision required of the DGGS.
However, as technology pushes the limits of available precision,
use-cases demand combining data from highly disparate sources,
and users push their expectations,
it becomes increasingly important to know when limits of use are reached.

The sources considered for inclusion in the  error budget can include:

[loweralpha]
. *spatial variation:* whether the available precision of each source of error is uniform or variable across the DGGS's domain;
. *datum:* precision of the underlying measurements for the datum;
. *static datum:* precision of the assertion that the coordinates are static both on the tectonic plate the datum is tied to, and away from the static plate;
. *earth model:* differences between the chosen ellipsoidal or spherical earth model
  and the real earth's surface.
  Spheres lead to faster and more precise computations for the tessellations
  but have a less precise fit to the real earth's surface.

While implementation issues are beyond the scope of this document,
the following sources may contribute to increases in error budgets for an implementation:

[loweralpha]
. *spherical maths:* exact solutions are available for solving the required mathematics on the surface of a sphere;
. *ellipsoidal maths:* solving the required mathematics on the surface of an ellipsoid
  requires the use of iterative numerical methods which result in approximate solutions
  with an uncertainty determined by both the method and the number of iterations
  used to perform the computation;
. *data-type precision:* most will probably use 64-bit double precision for location, anything less will have a significant impact on the error budget;
. *cell edge type:* geodesics, small circles, small ellipses, and projected lines each have different solutions with different consequences for their precision and performance.
At finer resolutions it may be possible to implement a simpler edge type and still stay within the implementation error budget;
. *error propagation:* the choice of strategy for implementing the sequence of tessellations.

The error budget puts a limit on the number of iterations in the sequence of refined discrete global grids. This is acknowledged in the requirements.

DGGSs may validly comprise more than one cell geometry.
This most typically arises for systems based on truncated polyhedra
such as the cuboctahedron -- with both square and triangular faces,
and the truncated icosahedron -- with pentagonal and hexagonal faces.
In these situations, equal area is interpreted to mean that all of the cells
of a particular geometry are equal area,
and that the ratio of the areas of the two geometries is preserved through the tessellations.
For example, in the truncated icosahedron used by ISEA the ratio of
pentagonal to hexagonal areas within a tessellation level is always 5/6.

The following requirements apply:
include::../requirements/REQ_ea-ers-cell-equal_area.adoc[]

[[defining-tables-for-cell]]
===== Defining tables

include::../tables/TAB_ea-c-i.adoc[]
. <<tab-EA_BoundaryType>> -- Elements of Equal-Area Cell::EA_BoundaryType

include::../tables/TAB_ea-c.adoc[]

[[tab-EA_BoundaryType]]
.Elements of Equal-Area Cell::EA_BoundaryType
[width="100%",cols="8%,10%,20%,20%,6%,8%,8%,20%",]
|===
|*Name:* 7+a| EA_BoundaryType
|*Definition:* 7+a| CodeList for permitted curve types as constructors of an EA_Cell boundary. +
*NOTE* All EA_BoundaryType curves can be constructed as an intersection of a plane and an ellipsoid.
So each of these curve types is a straight line on a designated plane.
|*Stereotype:* 7+a| CodeList
|*Abstract:* 7+a| true
.1+|*Associations:* 7+a| (none)
.7+|*Values:*  | _Name_ 6+a| _Definition_
 | geodesic 6+| Shortest path between two points on the spherical or ellipsoidal DGGS's earth reference model. Geodesic curves are defined using the GeodesicData constructor.
 | smallCircle 6+| Curves that are the intersection of a plane and an ellipsoid,
 where the plane is perpendicular to the axis of rotation of an ellipsoid are in small circles, see greatCircle.
 Lines of latitude are small circles.
 | greatCircle 6+| The great circle is a special case of small circle where the two focal points of the ellipse are also on the defining plane.
 On a non-spherical ellipsoid this is the only circle that is also a geodesic.
 | smallEllipse 6+| Curves that are the intersection of a plane and an ellipsoid,
 where the plane is parallel to the axis of rotation of the ellipsoid, are small ellipses, see greatEllipse.
 | greatEllipse 6+| A greatEllipse is a special case of smallEllipse where the axis of rotation is on the defining plane.
 GreatEllipses are geodesics.
 Lines of longitude are greatEllipses.
 | projectedLine 6+| A curve on the surface of an ellipsoid, whose equal-area projection on the projection's reference plane is a straight line.
|===

{empty} +
